

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>A brief tour of the library &mdash; Elemental</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Build system" href="build.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Elemental
          

          
          </a>

          
            
            
              <div class="version">
                0.86
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">A brief tour of the library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#boiler-plate-programs">Boiler-plate programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#floating-point-types">Floating-point types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#float">float</a></li>
<li class="toctree-l3"><a class="reference internal" href="#double">double</a></li>
<li class="toctree-l3"><a class="reference internal" href="#doubledouble">DoubleDouble</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quaddouble">QuadDouble</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quad">Quad</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bigfloat">BigFloat</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dense-linear-algebra">Dense linear algebra</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solving-linear-systems">Solving linear systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#a-sequential-hilbert-example">A sequential Hilbert example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-distributed-uniform-random-example">A distributed uniform random example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#factorizations-and-updating-them">Factorizations (and updating them)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cholesky">Cholesky</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bunch-kaufman">Bunch-Kaufman</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lu">LU</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qr">QR</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hermitian-eigensolvers-and-their-extensions">Hermitian eigensolvers (and their extensions)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hermitian-eigensolvers">Hermitian eigensolvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#skew-hermitian-eigensolvers">Skew-Hermitian eigensolvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hermitian-generalized-definite-eigensolvers">Hermitian generalized-definite eigensolvers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#singular-value-decompositions">Singular Value Decompositions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#schur-decompositions">Schur decompositions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pseudospectra">Pseudospectra</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sparse-direct-linear-and-generalized-least-squares-solvers">Sparse-direct linear and (generalized) least squares solvers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unpivoted-ldl">Unpivoted LDL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#symmetric-quasi-semidefinite-sqsd-systems">Symmetric Quasi-SemiDefinite (SQSD) systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#general-linear-systems">General linear systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#least-squares">Least Squares</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tikhonov">Tikhonov</a></li>
<li class="toctree-l3"><a class="reference internal" href="#equality-constrained-least-squares-lse">Equality-constrained Least Squares (LSE)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#general-linear-model-glm">General Linear Model (GLM)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#solving-linear-quadratic-programs-and-second-order-cone-programs">Solving Linear, Quadratic Programs, and Second-Order Cone Programs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#linear-programs">Linear Programs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quadratic-programs">Quadratic Programs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#second-order-cone-programs">Second-Order Cone Programs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lattice-reduction">Lattice reduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lenstra-lenstra-lovasz-lll-basis-reduction">Lenstra/Lenstra/Lovasz (LLL) basis reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#block-korkine-zolotarev-basis-reduction-and-its-extensions">Block Korkine-Zolotarev basis reduction (and its extensions)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vanilla-bkz">Vanilla BKZ</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bkz-2-0">“BKZ 2.0”</a></li>
<li class="toctree-l4"><a class="reference internal" href="#y-sparse-enumeration">“y-sparse” enumeration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#solving-shortest-vector-problems">Solving Shortest Vector Problems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integer-dependence-searches">Integer dependence searches</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#some-simple-number-theory-support">Some simple number theory support</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simple-integer-factorization">Simple integer factorization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#direct-sieving">Direct sieving</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pollard-s-rho-method">Pollard’s rho method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pollard-s-p-1-method">Pollard’s p-1 method</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#discrete-logarithms">Discrete logarithms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="blas_like.html">BLAS-like linear algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="lapack_like.html">LAPACK-like linear algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="control.html">Control theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrices.html">Special matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">Input/output</a></li>
<li class="toctree-l1"><a class="reference internal" href="indices.html">Indices</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Elemental</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>A brief tour of the library</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tour.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="a-brief-tour-of-the-library">
<h1>A brief tour of the library<a class="headerlink" href="#a-brief-tour-of-the-library" title="Permalink to this headline">¶</a></h1>
<p>This is just starting to be sketched and the details should be filled in soon.</p>
<div class="section" id="boiler-plate-programs">
<h2>Boiler-plate programs<a class="headerlink" href="#boiler-plate-programs" title="Permalink to this headline">¶</a></h2>
<p>Elemental installations include a file named <code class="docutils literal notranslate"><span class="pre">ElVars</span></code> which can be included
in a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> to simplify reproducing the build environment used for
building Elemental. For example, a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code></p>
<div class="highlight-Makefile notranslate"><div class="highlight"><pre><span></span><span class="cp">include /usr/local/conf/ElVars</span>
<span class="nf">%</span><span class="o">:</span> %.<span class="n">cpp</span>
      <span class="k">$(</span>CXX<span class="k">)</span> <span class="k">$(</span>EL_COMPILE_FLAGS<span class="k">)</span> $&lt; -o <span class="nv">$@</span> <span class="k">$(</span>EL_LINK_FLAGS<span class="k">)</span> <span class="k">$(</span>EL_LIBS<span class="k">)</span>
</pre></div>
</div>
<p>should successfully compile and link any <cite>.cpp</cite> drivers in the same folder as
the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> (after running <code class="docutils literal notranslate"><span class="pre">make</span></code>). A simple C++ driver for Elemental
should have a <code class="docutils literal notranslate"><span class="pre">main</span></code> of the basic form</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;El.hpp&gt;</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]</span> <span class="p">)</span>
<span class="p">{</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Environment</span> <span class="n">env</span><span class="p">(</span> <span class="n">argc</span><span class="p">,</span> <span class="n">argv</span> <span class="p">);</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="c1">// Nontrivial computation goes here</span>
  <span class="p">}</span> <span class="k">catch</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">except</span> <span class="p">)</span> <span class="p">{</span> <span class="n">El</span><span class="o">::</span><span class="n">ReportException</span><span class="p">(</span><span class="n">except</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>On OS X, successfully running said programs typically requires setting the
environment variable <code class="docutils literal notranslate"><span class="pre">DYLD_LIBRARY_PATH</span></code> to include the location of the
Elemental shared library, e.g., <code class="docutils literal notranslate"><span class="pre">/usr/local/lib</span></code>. On Unix systems, the
<code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code> variable should be set instead.</p>
<p>In order to use Elemental’s python interface, one must also set the <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> variable to include the <code class="docutils literal notranslate"><span class="pre">python/</span></code> subfolder of the installation, e.g.,
<code class="docutils literal notranslate"><span class="pre">/usr/local/python</span></code>. The program</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">El</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">El</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">El</span><span class="o">.</span><span class="n">dTag</span><span class="p">)</span>
<span class="n">El</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span> <span class="p">)</span>
<span class="n">El</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p>should print a 10 x 10 matrix if the configuration was successful.</p>
</div>
<div class="section" id="floating-point-types">
<h2>Floating-point types<a class="headerlink" href="#floating-point-types" title="Permalink to this headline">¶</a></h2>
<p>Elemental supports a variety of different floating-point types; the typical
order of increasing cost is <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, <code class="docutils literal notranslate"><span class="pre">El::DoubleDouble</span></code>,
<code class="docutils literal notranslate"><span class="pre">El::QuadDouble</span></code>, <code class="docutils literal notranslate"><span class="pre">El::Quad</span></code>, <code class="docutils literal notranslate"><span class="pre">El::BigFloat</span></code>. <code class="docutils literal notranslate"><span class="pre">El::DoubleDouble</span></code> and
<code class="docutils literal notranslate"><span class="pre">El::QuadDouble</span></code> are essentially concatenations of the mantissas of two and
four doubles (respectively), while <code class="docutils literal notranslate"><span class="pre">El::Quad</span></code> is an IEEE 128-bit format that
is typically implemented in software, and <code class="docutils literal notranslate"><span class="pre">El::BigFloat</span></code> is a wrapper for
GNU MPFR’s arbitrary-precision floating-point arithmetic.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;El.hpp&gt;</span><span class="cp"></span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Real</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">QueryLimits</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;base:      &quot;</span><span class="p">,</span><span class="n">El</span><span class="o">::</span><span class="n">limits</span><span class="o">::</span><span class="n">Base</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span><span class="p">());</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;epsilon:   &quot;</span><span class="p">,</span><span class="n">El</span><span class="o">::</span><span class="n">limits</span><span class="o">::</span><span class="n">Epsilon</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span><span class="p">());</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;precision: &quot;</span><span class="p">,</span><span class="n">El</span><span class="o">::</span><span class="n">limits</span><span class="o">::</span><span class="n">Precision</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span><span class="p">());</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;min:       &quot;</span><span class="p">,</span><span class="n">El</span><span class="o">::</span><span class="n">limits</span><span class="o">::</span><span class="n">Min</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span><span class="p">());</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;max:       &quot;</span><span class="p">,</span><span class="n">El</span><span class="o">::</span><span class="n">limits</span><span class="o">::</span><span class="n">Max</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span><span class="p">());</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;lowest:    &quot;</span><span class="p">,</span><span class="n">El</span><span class="o">::</span><span class="n">limits</span><span class="o">::</span><span class="n">Lowest</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="float">
<h3>float<a class="headerlink" href="#float" title="Permalink to this headline">¶</a></h3>
<p>The 32-bit IEEE floating-point type yields an output from
<code class="docutils literal notranslate"><span class="pre">QueryLimits&lt;float&gt;()</span></code> of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base</span><span class="p">:</span>      <span class="mi">2</span>
<span class="n">epsilon</span><span class="p">:</span>   <span class="mf">5.96046e-08</span>
<span class="n">precision</span><span class="p">:</span> <span class="mf">1.19209e-07</span>
<span class="nb">min</span><span class="p">:</span>       <span class="mf">1.17549e-38</span>
<span class="nb">max</span><span class="p">:</span>       <span class="mf">3.40282e+38</span>
<span class="n">lowest</span><span class="p">:</span>    <span class="o">-</span><span class="mf">3.40282e+38</span>
</pre></div>
</div>
</div>
<div class="section" id="double">
<h3>double<a class="headerlink" href="#double" title="Permalink to this headline">¶</a></h3>
<p>The 64-bit IEEE floating-point type yields an output from
<code class="docutils literal notranslate"><span class="pre">QueryLimits&lt;double&gt;()</span></code> of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base</span><span class="p">:</span>      <span class="mi">2</span>
<span class="n">epsilon</span><span class="p">:</span>   <span class="mf">1.11022e-16</span>
<span class="n">precision</span><span class="p">:</span> <span class="mf">2.22045e-16</span>
<span class="nb">min</span><span class="p">:</span>       <span class="mf">2.22507e-308</span>
<span class="nb">max</span><span class="p">:</span>       <span class="mf">1.79769e+308</span>
<span class="n">lowest</span><span class="p">:</span>    <span class="o">-</span><span class="mf">1.79769e+308</span>
</pre></div>
</div>
</div>
<div class="section" id="doubledouble">
<h3>DoubleDouble<a class="headerlink" href="#doubledouble" title="Permalink to this headline">¶</a></h3>
<p>The concatenation of the mantissas from two 64-bit IEEE floating-point types,
<code class="docutils literal notranslate"><span class="pre">El::DoubleDouble</span></code>, results in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base</span><span class="p">:</span>      <span class="mf">2.000000e+00</span>
<span class="n">epsilon</span><span class="p">:</span>   <span class="mf">2.465190e-32</span>
<span class="n">precision</span><span class="p">:</span> <span class="mf">4.930381e-32</span>
<span class="nb">min</span><span class="p">:</span>       <span class="mf">2.004168e-292</span>
<span class="nb">max</span><span class="p">:</span>       <span class="mf">1.797693e+308</span>
<span class="n">lowest</span><span class="p">:</span>    <span class="o">-</span><span class="mf">1.797693e+308</span>
</pre></div>
</div>
<p>This datatype is only available if Elemental was configured with support for the
package <a class="reference external" href="http://crd-legacy.lbl.gov/~dhbailey/mpdist/">QD</a> (the preprocessor definition <code class="docutils literal notranslate"><span class="pre">EL_HAVE_QD</span></code> will exist if this is the case).</p>
</div>
<div class="section" id="quaddouble">
<h3>QuadDouble<a class="headerlink" href="#quaddouble" title="Permalink to this headline">¶</a></h3>
<p>The concatenation of the mantissas from four 64-bit IEEE floating-point types,
<code class="docutils literal notranslate"><span class="pre">El::QuadDouble</span></code>, results in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base</span><span class="p">:</span>      <span class="mf">2.000000e+00</span>
<span class="n">epsilon</span><span class="p">:</span>   <span class="mf">6.077163e-64</span>
<span class="n">precision</span><span class="p">:</span> <span class="mf">1.215433e-63</span>
<span class="nb">min</span><span class="p">:</span>       <span class="mf">1.625975e-260</span>
<span class="nb">max</span><span class="p">:</span>       <span class="mf">1.797693e+308</span>
<span class="n">lowest</span><span class="p">:</span>    <span class="o">-</span><span class="mf">1.797693e+308</span>
</pre></div>
</div>
<p>Like <code class="docutils literal notranslate"><span class="pre">El::DoubleDouble</span></code>, this datatype is only available if Elemental was
configured with support for the package
<a class="reference external" href="http://crd-legacy.lbl.gov/~dhbailey/mpdist/">QD</a> (the preprocessor
definition <code class="docutils literal notranslate"><span class="pre">EL_HAVE_QD</span></code> will exist if this is the case).</p>
</div>
<div class="section" id="quad">
<h3>Quad<a class="headerlink" href="#quad" title="Permalink to this headline">¶</a></h3>
<p>The 128-bit IEEE floating-point type (which is made available by the GNU and Intel compilers), <code class="docutils literal notranslate"><span class="pre">El::Quad</span></code>, yields:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base</span><span class="p">:</span>      <span class="mf">2.000000e+00</span>
<span class="n">epsilon</span><span class="p">:</span>   <span class="mf">9.629650e-35</span>
<span class="n">precision</span><span class="p">:</span> <span class="mf">1.925930e-34</span>
<span class="nb">min</span><span class="p">:</span>       <span class="mf">3.362103e-4932</span>
<span class="nb">max</span><span class="p">:</span>       <span class="mf">1.189731e+4932</span>
<span class="n">lowest</span><span class="p">:</span>    <span class="o">-</span><span class="mf">1.189731e+4932</span>
</pre></div>
</div>
<p>This datatype is only available if Elemental was configured with support for
<code class="docutils literal notranslate"><span class="pre">__float128</span></code> via
<a class="reference external" href="https://gcc.gnu.org/onlinedocs/libquadmath/">libquadmath</a>
(the preprocessor definition <code class="docutils literal notranslate"><span class="pre">EL_HAVE_QUAD</span></code> will exist if this is the case).</p>
</div>
<div class="section" id="bigfloat">
<h3>BigFloat<a class="headerlink" href="#bigfloat" title="Permalink to this headline">¶</a></h3>
<p>The arbitrary-precision floating-point type in Elemental, <code class="docutils literal notranslate"><span class="pre">El::BigFloat</span></code>,
which currently builds on top of GNU MPFR, defaults to 256-bit but is
configurable at runtime with the routine
<code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">El::mpfr::SetPrecision(</span> <span class="pre">mpfr_prec_t</span> <span class="pre">precision</span> <span class="pre">)</span></code>. With the default
choice of 256 bits, the output of our <code class="docutils literal notranslate"><span class="pre">QueryLimits</span></code> function is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base</span><span class="p">:</span>      <span class="mi">2</span>
<span class="n">epsilon</span><span class="p">:</span>   <span class="mf">8.63616855509444462538635186280039957111600036443628138502370347016859180316243e-78</span>
<span class="n">precision</span><span class="p">:</span> <span class="mf">1.72723371101888892507727037256007991422320007288725627700474069403371836063249e-77</span>
<span class="nb">min</span><span class="p">:</span>       <span class="mf">2.38256490488795107321616978173267452041519612555923978795502375260094538610432e-323228497</span>
<span class="nb">max</span><span class="p">:</span>       <span class="mf">2.09857871646738769240435811688383907063809796547335262778664622571024044777575e+323228496</span>
<span class="n">lowest</span><span class="p">:</span>    <span class="o">-</span><span class="mf">2.09857871646738769240435811688383907063809796547335262778664622571024044777575e+323228496</span>
</pre></div>
</div>
<p>After a call to <code class="docutils literal notranslate"><span class="pre">El::mpfr::SetPrecision(</span> <span class="pre">1024</span> <span class="pre">)</span></code>, the output should become:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base</span><span class="p">:</span>      <span class="mi">2</span>
<span class="n">epsilon</span><span class="p">:</span>   <span class="mf">5.56268464626800345772558179333101016054803995115582957638331854221801108703479548963570789753127755141016834932758952751288108540388365027214003096344429705282694498383000582619902536860645909017980391261735625933552093812701662654164539737180122794992147909912125158977192529576218699945221938437487362895113e-309</span>
<span class="n">precision</span><span class="p">:</span> <span class="mf">1.11253692925360069154511635866620203210960799023116591527666370844360221740695909792714157950625551028203366986551790550257621708077673005442800619268885941056538899676600116523980507372129181803596078252347125186710418762540332530832907947436024558998429581982425031795438505915243739989044387687497472579023e-308</span>
<span class="nb">min</span><span class="p">:</span>       <span class="mf">2.38256490488795107321616978173267452041519612555923978795502375260094538610432437489305775137932142344261757534893513700376849772992139878050298035792983488792657869701244309719036212063256710725856070515025356232010332123318365401263732225092389771322296946086646765801855827879773904684428316399822674037349e-323228497</span>
<span class="nb">max</span><span class="p">:</span>       <span class="mf">2.09857871646738769240435811688383907063809796547335262778664622571024044777576820818355304081267655987295599577960564840596747121502665142009783113610500048360066244023816505568400011005103679303701081473191703433515051267336632313268218262621740510855082829034802224115869883581782547386877774641524094504273e+323228496</span>
<span class="n">lowest</span><span class="p">:</span>    <span class="o">-</span><span class="mf">2.09857871646738769240435811688383907063809796547335262778664622571024044777576820818355304081267655987295599577960564840596747121502665142009783113610500048360066244023816505568400011005103679303701081473191703433515051267336632313268218262621740510855082829034802224115869883581782547386877774641524094504273e+323228496</span>
</pre></div>
</div>
<p>This datatype is only available if Elemental was configured with support for
<a class="reference external" href="http://www.mpfr.org/">MPFR</a> and
<a class="reference external" href="http://www.multiprecision.org/index.php?prog=mpc">MPC</a>
(the preprocessor definition <code class="docutils literal notranslate"><span class="pre">EL_HAVE_MPC</span></code> will exist if this is the case).</p>
</div>
</div>
<div class="section" id="dense-linear-algebra">
<h2>Dense linear algebra<a class="headerlink" href="#dense-linear-algebra" title="Permalink to this headline">¶</a></h2>
<div class="section" id="solving-linear-systems">
<h3>Solving linear systems<a class="headerlink" href="#solving-linear-systems" title="Permalink to this headline">¶</a></h3>
<div class="section" id="a-sequential-hilbert-example">
<h4>A sequential Hilbert example<a class="headerlink" href="#a-sequential-hilbert-example" title="Permalink to this headline">¶</a></h4>
<p>As a pathological example, the following routine can be used to test a
Cholesky-based linear system solver on a Hilbert matrix for various precisions:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Real</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">SolveHilbert</span><span class="p">(</span> <span class="n">Int</span> <span class="n">n</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;Attempting to solve Hilbert system with &quot;</span><span class="p">,</span><span class="n">El</span><span class="o">::</span><span class="n">TypeName</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span><span class="p">());</span>

    <span class="c1">// Form an n x n Hilbert matrix</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Hilbert</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="n">n</span> <span class="p">);</span>

    <span class="c1">// Form a uniform random vector</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="k">const</span> <span class="n">Real</span> <span class="n">xFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">x</span> <span class="p">);</span>

    <span class="c1">// Form b := A x using a GEneral Matrix Vector (GEMV) product.</span>
    <span class="c1">// The terminology is derived from the BLAS naming convention.</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Gemv</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span> <span class="p">);</span>
    <span class="k">const</span> <span class="n">Real</span> <span class="n">bFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">b</span> <span class="p">);</span>

    <span class="c1">// Form xComp := inv(A) b using a solver that exploits the fact that</span>
    <span class="c1">// Hilbert matrices are Hermitian Positive-Definite (HPD).</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">xComp</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">HPDSolve</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">LOWER</span><span class="p">,</span> <span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">xComp</span> <span class="p">);</span>

    <span class="c1">// Form r := b - A x</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">r</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Gemv</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">A</span><span class="p">,</span> <span class="n">xComp</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">r</span> <span class="p">);</span>
    <span class="k">const</span> <span class="n">Real</span> <span class="n">rFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">r</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;|| r ||_2 / || b ||_2 = &quot;</span><span class="p">,</span><span class="n">rFrob</span><span class="o">/</span><span class="n">bFrob</span><span class="p">);</span>

    <span class="c1">// Form e := x - xComp</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">e</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="n">e</span> <span class="o">-=</span> <span class="n">xComp</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">Real</span> <span class="n">eFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">e</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;|| e ||_2 / || x ||_2 = &quot;</span><span class="p">,</span><span class="n">eFrob</span><span class="o">/</span><span class="n">xFrob</span><span class="p">);</span>

    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">main</span></code> function for calling this should ideally separately handle exceptions
for each datatype, as it turns out that neither single-precision nor
double-precision can successfully factor 20 x 20 Hilbert matrices:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Environment</span> <span class="n">env</span><span class="p">(</span> <span class="n">argc</span><span class="p">,</span> <span class="n">argv</span> <span class="p">);</span>
    <span class="k">try</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">Input</span><span class="p">(</span><span class="s">&quot;--n&quot;</span><span class="p">,</span><span class="s">&quot;matrix width&quot;</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
<span class="cp">#ifdef EL_HAVE_MPC</span>
        <span class="n">mpfr_prec_t</span> <span class="n">prec</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">Input</span><span class="p">(</span><span class="s">&quot;--prec&quot;</span><span class="p">,</span><span class="s">&quot;MPFR precision&quot;</span><span class="p">,</span><span class="mi">256</span><span class="p">);</span>
<span class="cp">#endif</span>
        <span class="n">El</span><span class="o">::</span><span class="n">ProcessInput</span><span class="p">();</span>

<span class="cp">#ifdef EL_HAVE_MPC</span>
        <span class="n">El</span><span class="o">::</span><span class="n">mpfr</span><span class="o">::</span><span class="n">SetPrecision</span><span class="p">(</span> <span class="n">prec</span> <span class="p">);</span>
<span class="cp">#endif</span>

        <span class="k">try</span> <span class="p">{</span> <span class="n">SolveHilbert</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">n</span> <span class="p">);</span> <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">e</span> <span class="p">)</span> <span class="p">{</span> <span class="n">El</span><span class="o">::</span><span class="n">ReportException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">try</span> <span class="p">{</span> <span class="n">SolveHilbert</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">n</span> <span class="p">);</span> <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">e</span> <span class="p">)</span> <span class="p">{</span> <span class="n">El</span><span class="o">::</span><span class="n">ReportException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="p">}</span>
<span class="cp">#ifdef EL_HAVE_QD</span>
        <span class="k">try</span> <span class="p">{</span> <span class="n">SolveHilbert</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">DoubleDouble</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">n</span> <span class="p">);</span> <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">e</span> <span class="p">)</span> <span class="p">{</span> <span class="n">El</span><span class="o">::</span><span class="n">ReportException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">try</span> <span class="p">{</span> <span class="n">SolveHilbert</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">QuadDouble</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">n</span> <span class="p">);</span> <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">e</span> <span class="p">)</span> <span class="p">{</span> <span class="n">El</span><span class="o">::</span><span class="n">ReportException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="p">}</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef EL_HAVE_QUAD</span>
        <span class="k">try</span> <span class="p">{</span> <span class="n">SolveHilbert</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">Quad</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">n</span> <span class="p">);</span> <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">e</span> <span class="p">)</span> <span class="p">{</span> <span class="n">El</span><span class="o">::</span><span class="n">ReportException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="p">}</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef EL_HAVE_MPC</span>
        <span class="k">try</span> <span class="p">{</span> <span class="n">SolveHilbert</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">BigFloat</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">n</span> <span class="p">);</span> <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">e</span> <span class="p">)</span> <span class="p">{</span> <span class="n">El</span><span class="o">::</span><span class="n">ReportException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="p">}</span>
<span class="cp">#endif</span>
    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">e</span> <span class="p">)</span> <span class="p">{</span> <span class="n">El</span><span class="o">::</span><span class="n">ReportException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For a 20 x 20 Hilbert matrix, one should see output of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">Hilbert</span> <span class="n">system</span> <span class="k">with</span> <span class="nb">float</span>
<span class="n">Process</span> <span class="mi">0</span> <span class="n">caught</span> <span class="n">error</span> <span class="n">message</span><span class="p">:</span>
<span class="n">A</span> <span class="n">was</span> <span class="ow">not</span> <span class="n">numerically</span> <span class="n">HPD</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">Hilbert</span> <span class="n">system</span> <span class="k">with</span> <span class="n">double</span>
<span class="n">Process</span> <span class="mi">0</span> <span class="n">caught</span> <span class="n">error</span> <span class="n">message</span><span class="p">:</span>
<span class="n">A</span> <span class="n">was</span> <span class="ow">not</span> <span class="n">numerically</span> <span class="n">HPD</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">Hilbert</span> <span class="n">system</span> <span class="k">with</span> <span class="n">DoubleDouble</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">3.543271e-32</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">3.538193e-06</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">Hilbert</span> <span class="n">system</span> <span class="k">with</span> <span class="n">QuadDouble</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">2.506190e-65</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">2.439582e-38</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">Hilbert</span> <span class="n">system</span> <span class="k">with</span> <span class="n">Quad</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">2.745784e-34</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">7.907429e-08</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">Hilbert</span> <span class="n">system</span> <span class="k">with</span> <span class="n">BigFloat</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">1.9482282137301946384577456453427454630087917713177475059958544871005206470301e-77</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">2.28840034493301788424999659531588179908629747565564912546598839357700494446305e-51</span>
</pre></div>
</div>
<p>A cursory comparison of the residual and solution errors relative to machine epsilon reveals that the relative residuals are near optimal but the relative
solution error loses about 26 digits of accuracy. Because the relative residuals
are on the order of machine epsilon, iterative refinement cannot be expected to
yield any improvement.</p>
</div>
<div class="section" id="a-distributed-uniform-random-example">
<h4>A distributed uniform random example<a class="headerlink" href="#a-distributed-uniform-random-example" title="Permalink to this headline">¶</a></h4>
<p>Modest changes to the above sequential example provide a distributed
(real or complex) analogue for uniform random matrices:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Field</span><span class="o">&gt;</span> <span class="c1">// &#39;Field&#39; can be complex, e.g., El::Complex&lt;double&gt;</span>
<span class="kt">void</span> <span class="n">SolveUniform</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">n</span><span class="p">,</span> <span class="k">const</span> <span class="n">El</span><span class="o">::</span><span class="n">Grid</span><span class="o">&amp;</span> <span class="n">grid</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Since &#39;Field&#39; could be real or complex, Elemental has a convenience</span>
    <span class="c1">// template for extracting the real &#39;base&#39; field.</span>
    <span class="k">typedef</span> <span class="n">El</span><span class="o">::</span><span class="n">Base</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">Real</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">grid</span><span class="p">.</span><span class="n">Rank</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Output</span>
        <span class="p">(</span><span class="s">&quot;Attempting to solve uniform system with &quot;</span><span class="p">,</span><span class="n">El</span><span class="o">::</span><span class="n">TypeName</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span><span class="p">());</span>

    <span class="c1">// Form an n x n random matrix with i.i.d. entries sampled from the</span>
    <span class="c1">// uniform distribution over the ball of radius &#39;radius&#39; centered at</span>
    <span class="k">const</span> <span class="n">Field</span> <span class="n">center</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="c1">// center samples at the origin</span>
    <span class="k">const</span> <span class="n">Real</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// sample over ball of radius 1</span>
    <span class="n">El</span><span class="o">::</span><span class="n">DistMatrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">(</span><span class="n">grid</span><span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span> <span class="p">);</span>

    <span class="c1">// Form a uniform random vector</span>
    <span class="n">El</span><span class="o">::</span><span class="n">DistMatrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">(</span><span class="n">grid</span><span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="k">const</span> <span class="n">Real</span> <span class="n">xFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">x</span> <span class="p">);</span>

    <span class="c1">// Form b := A x using a GEneral Matrix Vector (GEMV) product.</span>
    <span class="c1">// The terminology is derived from the BLAS naming convention.</span>
    <span class="n">El</span><span class="o">::</span><span class="n">DistMatrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">(</span><span class="n">grid</span><span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Gemv</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span> <span class="p">);</span>
    <span class="k">const</span> <span class="n">Real</span> <span class="n">bFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">b</span> <span class="p">);</span>

    <span class="c1">// Form xComp := inv(A) b</span>
    <span class="n">El</span><span class="o">::</span><span class="n">DistMatrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">xComp</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">LinearSolve</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="n">xComp</span> <span class="p">);</span>

    <span class="c1">// Form r := b - A x</span>
    <span class="n">El</span><span class="o">::</span><span class="n">DistMatrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">r</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Gemv</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">A</span><span class="p">,</span> <span class="n">xComp</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">r</span> <span class="p">);</span>
    <span class="k">const</span> <span class="n">Real</span> <span class="n">rFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">r</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">grid</span><span class="p">.</span><span class="n">Rank</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;|| r ||_2 / || b ||_2 = &quot;</span><span class="p">,</span><span class="n">rFrob</span><span class="o">/</span><span class="n">bFrob</span><span class="p">);</span>

    <span class="c1">// Form e := x - xComp</span>
    <span class="n">El</span><span class="o">::</span><span class="n">DistMatrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">e</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="n">e</span> <span class="o">-=</span> <span class="n">xComp</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">Real</span> <span class="n">eFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">e</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">grid</span><span class="p">.</span><span class="n">Rank</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;|| e ||_2 / || x ||_2 = &quot;</span><span class="p">,</span><span class="n">eFrob</span><span class="o">/</span><span class="n">xFrob</span><span class="p">);</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>An extremely basic (especially in the sense of not configuring the process grid)
example of driving the above routine for the suite of datatypes is given below.
Unlike the previous example, there is no need to wrap every single test with an
try/catch block since we are not attempting to solve pathologically
ill-conditioned systems.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Environment</span> <span class="n">env</span><span class="p">(</span> <span class="n">argc</span><span class="p">,</span> <span class="n">argv</span> <span class="p">);</span>
    <span class="k">try</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">Input</span><span class="p">(</span><span class="s">&quot;--n&quot;</span><span class="p">,</span><span class="s">&quot;matrix width&quot;</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
<span class="cp">#ifdef EL_HAVE_MPC</span>
        <span class="n">mpfr_prec_t</span> <span class="n">prec</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">Input</span><span class="p">(</span><span class="s">&quot;--prec&quot;</span><span class="p">,</span><span class="s">&quot;MPFR precision&quot;</span><span class="p">,</span><span class="mi">256</span><span class="p">);</span>
<span class="cp">#endif</span>
        <span class="n">El</span><span class="o">::</span><span class="n">ProcessInput</span><span class="p">();</span>

<span class="cp">#ifdef EL_HAVE_MPC</span>
        <span class="n">El</span><span class="o">::</span><span class="n">mpfr</span><span class="o">::</span><span class="n">SetPrecision</span><span class="p">(</span> <span class="n">prec</span> <span class="p">);</span>
<span class="cp">#endif</span>

        <span class="c1">// While this is equivalent to the default constructor, it is a</span>
        <span class="c1">// middle-of-the-road example of building a process grid. If</span>
        <span class="c1">// performance is important, passing in a good height for the process</span>
        <span class="c1">// grid (and ensuring a good mapping of processes to your network)</span>
        <span class="c1">// is highly recommended.</span>
        <span class="k">const</span> <span class="n">El</span><span class="o">::</span><span class="n">Grid</span> <span class="n">grid</span><span class="p">(</span><span class="n">El</span><span class="o">::</span><span class="n">mpi</span><span class="o">::</span><span class="n">COMM_WORLD</span><span class="p">);</span>

        <span class="n">SolveUniform</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="p">);</span>
        <span class="n">SolveUniform</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">Complex</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;&gt;</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="p">);</span>
        <span class="n">SolveUniform</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="p">);</span>
        <span class="n">SolveUniform</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">Complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="p">);</span>
<span class="cp">#ifdef EL_HAVE_QD</span>
        <span class="n">SolveUniform</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">DoubleDouble</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="p">);</span>
        <span class="n">SolveUniform</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">Complex</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">DoubleDouble</span><span class="o">&gt;&gt;</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="p">);</span>
        <span class="n">SolveUniform</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">QuadDouble</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="p">);</span>
        <span class="n">SolveUniform</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">Complex</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">QuadDouble</span><span class="o">&gt;&gt;</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="p">);</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef EL_HAVE_QUAD</span>
        <span class="n">SolveUniform</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">Quad</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="p">);</span>
        <span class="n">SolveUniform</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">Complex</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">Quad</span><span class="o">&gt;&gt;</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="p">);</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef EL_HAVE_MPC</span>
        <span class="n">SolveUniform</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">BigFloat</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="p">);</span>
        <span class="n">SolveUniform</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">Complex</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">BigFloat</span><span class="o">&gt;&gt;</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="p">);</span>
<span class="cp">#endif</span>
    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">e</span> <span class="p">)</span> <span class="p">{</span> <span class="n">El</span><span class="o">::</span><span class="n">ReportException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>One should see output of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">uniform</span> <span class="n">system</span> <span class="k">with</span> <span class="nb">float</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">2.67869e-07</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">5.59922e-06</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">uniform</span> <span class="n">system</span> <span class="k">with</span> <span class="n">Complex</span><span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">2.90457e-07</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">1.6407e-06</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">uniform</span> <span class="n">system</span> <span class="k">with</span> <span class="n">double</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">5.45493e-16</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">1.74868e-15</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">uniform</span> <span class="n">system</span> <span class="k">with</span> <span class="n">Complex</span><span class="o">&lt;</span><span class="n">double</span><span class="o">&gt;</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">5.74873e-16</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">1.04947e-15</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">uniform</span> <span class="n">system</span> <span class="k">with</span> <span class="n">DoubleDouble</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">5.287884e-32</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">7.218625e-32</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">uniform</span> <span class="n">system</span> <span class="k">with</span> <span class="n">Complex</span><span class="o">&lt;</span><span class="n">DoubleDouble</span><span class="o">&gt;</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">6.457957e-32</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">1.449757e-31</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">uniform</span> <span class="n">system</span> <span class="k">with</span> <span class="n">QuadDouble</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">1.235778e-64</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">7.264402e-64</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">uniform</span> <span class="n">system</span> <span class="k">with</span> <span class="n">Complex</span><span class="o">&lt;</span><span class="n">QuadDouble</span><span class="o">&gt;</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">2.222868e-64</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">7.022524e-64</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">uniform</span> <span class="n">system</span> <span class="k">with</span> <span class="n">Quad</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">3.638647e-34</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">2.493450e-33</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">uniform</span> <span class="n">system</span> <span class="k">with</span> <span class="n">Complex</span><span class="o">&lt;</span><span class="n">Quad</span><span class="o">&gt;</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">4.912223e-34</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">1.251209e-32</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">uniform</span> <span class="n">system</span> <span class="k">with</span> <span class="n">BigFloat</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">2.16653828655365239586948146682077468955614163540705037520406655402511420652447e-77</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">2.97048990994165182685234224120022319803727420306104459599455276499915869056496e-76</span>

<span class="n">Attempting</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">uniform</span> <span class="n">system</span> <span class="k">with</span> <span class="n">Complex</span><span class="o">&lt;</span><span class="n">BigFloat</span><span class="o">&gt;</span>
<span class="o">||</span> <span class="n">r</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">3.24738616195777851543838631131220519424253089607715836789726606336887173848747e-77</span>
<span class="o">||</span> <span class="n">e</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">x</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">3.17455703192509779735989674848792372192302739322476068009648661219152697503029e-76</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="factorizations-and-updating-them">
<h3>Factorizations (and updating them)<a class="headerlink" href="#factorizations-and-updating-them" title="Permalink to this headline">¶</a></h3>
<div class="section" id="cholesky">
<h4>Cholesky<a class="headerlink" href="#cholesky" title="Permalink to this headline">¶</a></h4>
<p>Elemental provides sequential and distributed implementations (for its suite
of datatypes) for Cholesky factorizations and quadratic-time low-rank
factorization updates and downdates. The following shows a generic routine
for exercising these interfaces in a sequential environment:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Field</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">FormAndUpdateCholesky</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">n</span><span class="p">,</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">rank</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">print</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;Testing Cholesky updates with &quot;</span><span class="p">,</span><span class="n">El</span><span class="o">::</span><span class="n">TypeName</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span><span class="p">());</span>
    <span class="k">typedef</span> <span class="n">El</span><span class="o">::</span><span class="n">Base</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">Real</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Timer</span> <span class="n">timer</span><span class="p">;</span>

    <span class="c1">// Generate a uniform random n x n matrix A.</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">print</span> <span class="p">)</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="s">&quot;A&quot;</span> <span class="p">);</span>

    <span class="c1">// Form the Symmetric Positive Semi-Definite matrix C := A A^H + I.</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Identity</span><span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Herk</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">LOWER</span><span class="p">,</span> <span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">A</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">C</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">print</span> <span class="p">)</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="s">&quot;C&quot;</span> <span class="p">);</span>

    <span class="c1">// Overwrite the lower triangle of C with its Cholesky factor.</span>
    <span class="n">timer</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Cholesky</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">LOWER</span><span class="p">,</span> <span class="n">C</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;Initial Cholesky: &quot;</span><span class="p">,</span><span class="n">timer</span><span class="p">.</span><span class="n">Stop</span><span class="p">(),</span><span class="s">&quot; [sec]&quot;</span><span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">MakeTrapezoidal</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">LOWER</span><span class="p">,</span> <span class="n">C</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">print</span> <span class="p">)</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="s">&quot;Cholesky factor of C&quot;</span> <span class="p">);</span>

    <span class="c1">// Update the Cholesky factor of C to the Cholesky factor of C + 2 U U^H.</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">U</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">U</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">rank</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">print</span> <span class="p">)</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">U</span><span class="p">,</span> <span class="s">&quot;U&quot;</span> <span class="p">);</span>
    <span class="n">timer</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
    <span class="n">El</span><span class="o">::</span><span class="n">CholeskyMod</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">LOWER</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">U</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;Cholesky update of rank &quot;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="s">&quot;: &quot;</span><span class="p">,</span><span class="n">timer</span><span class="p">.</span><span class="n">Stop</span><span class="p">(),</span><span class="s">&quot; [sec]&quot;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">print</span> <span class="p">)</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="s">&quot;Cholesky factor of C + 2 U U^H&quot;</span> <span class="p">);</span>

    <span class="c1">// Downdate Cholesky factor to C + 2 U U^H - V V^H, with || V ||_F = 1.</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">V</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">V</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">rank</span> <span class="p">);</span>
    <span class="k">const</span> <span class="n">Real</span> <span class="n">VOrigFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">V</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Scale</span><span class="p">(</span> <span class="n">Field</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">VOrigFrob</span><span class="p">,</span> <span class="n">V</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">print</span> <span class="p">)</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">V</span><span class="p">,</span> <span class="s">&quot;V&quot;</span> <span class="p">);</span>
    <span class="n">timer</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
    <span class="n">El</span><span class="o">::</span><span class="n">CholeskyMod</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">LOWER</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">V</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;Cholesky downdate of rank &quot;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="s">&quot;: &quot;</span><span class="p">,</span><span class="n">timer</span><span class="p">.</span><span class="n">Stop</span><span class="p">(),</span><span class="s">&quot; [sec]&quot;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">print</span> <span class="p">)</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="s">&quot;Cholesky factor of C + 2 U U^H - V V^H&quot;</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Running on a recent Macbook Pro with Accelerate and <code class="docutils literal notranslate"><span class="pre">VECLIB_MAXIMUM_THREADS=1</span></code>
for 4000 x 4000 matrices and rank-two modifications should produce
output of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Testing</span> <span class="k">with</span> <span class="nb">float</span>
<span class="n">Initial</span> <span class="n">Cholesky</span><span class="p">:</span> <span class="mf">0.351594</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">Cholesky</span> <span class="n">update</span> <span class="n">of</span> <span class="n">rank</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">0.0181482</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">Cholesky</span> <span class="n">downdate</span> <span class="n">of</span> <span class="n">rank</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">0.0203956</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>

<span class="n">Testing</span> <span class="k">with</span> <span class="n">Complex</span><span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
<span class="n">Initial</span> <span class="n">Cholesky</span><span class="p">:</span> <span class="mf">3.78963</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">Cholesky</span> <span class="n">update</span> <span class="n">of</span> <span class="n">rank</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">0.0632135</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">Cholesky</span> <span class="n">downdate</span> <span class="n">of</span> <span class="n">rank</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">0.0666767</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>

<span class="n">Testing</span> <span class="k">with</span> <span class="n">double</span>
<span class="n">Initial</span> <span class="n">Cholesky</span><span class="p">:</span> <span class="mf">0.679954</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">Cholesky</span> <span class="n">update</span> <span class="n">of</span> <span class="n">rank</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">0.0236046</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">Cholesky</span> <span class="n">downdate</span> <span class="n">of</span> <span class="n">rank</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">0.0277888</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>

<span class="n">Testing</span> <span class="k">with</span> <span class="n">Complex</span><span class="o">&lt;</span><span class="n">double</span><span class="o">&gt;</span>
<span class="n">Initial</span> <span class="n">Cholesky</span><span class="p">:</span> <span class="mf">7.64342</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">Cholesky</span> <span class="n">update</span> <span class="n">of</span> <span class="n">rank</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">0.104679</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">Cholesky</span> <span class="n">downdate</span> <span class="n">of</span> <span class="n">rank</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">0.10832</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="bunch-kaufman">
<h4>Bunch-Kaufman<a class="headerlink" href="#bunch-kaufman" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="lu">
<h4>LU<a class="headerlink" href="#lu" title="Permalink to this headline">¶</a></h4>
<p>Elemental provides sequential and distributed implementations of Gaussian
Elimination with no pivoting, partial pivoting, and full pivoting, as well as
quadratic-time algorithms for performing low-rank modifications of an existing
factorization.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The 0.87.5 release only supported a rank-one LU update interface, while
0.87.6 supports a higher-rank interfaces that calls the rank-one interface
in a loop. This approach will be replaced with a (much faster) single-pass
low-rank updating scheme in future releases.</p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Field</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">FormAndUpdateLU</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">n</span><span class="p">,</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">rank</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">print</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;Testing LU updates with &quot;</span><span class="p">,</span><span class="n">El</span><span class="o">::</span><span class="n">TypeName</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span><span class="p">());</span>
    <span class="k">typedef</span> <span class="n">El</span><span class="o">::</span><span class="n">Base</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">Real</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Timer</span> <span class="n">timer</span><span class="p">;</span>

    <span class="c1">// Generate a random n x n matrix A.</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">print</span> <span class="p">)</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="s">&quot;A&quot;</span> <span class="p">);</span>

    <span class="c1">// Overwrite A with its LU factorization (with partial pivoting).</span>
    <span class="n">timer</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Permutation</span> <span class="n">P</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">LU</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="n">P</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;Initial LU: &quot;</span><span class="p">,</span><span class="n">timer</span><span class="p">.</span><span class="n">Stop</span><span class="p">(),</span><span class="s">&quot; [sec]&quot;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">print</span> <span class="p">)</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="s">&quot;In-place LU of A&quot;</span> <span class="p">);</span>

    <span class="c1">// Update the LU factors of A to those of A + 2 X Y^H.</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">X</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">rank</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">rank</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">print</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">X</span><span class="p">,</span> <span class="s">&quot;X&quot;</span> <span class="p">);</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&quot;Y&quot;</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="n">timer</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
    <span class="k">const</span> <span class="kt">bool</span> <span class="n">conjugate</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">LUMod</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">conjugate</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;LU update of rank &quot;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="s">&quot;: &quot;</span><span class="p">,</span><span class="n">timer</span><span class="p">.</span><span class="n">Stop</span><span class="p">(),</span><span class="s">&quot; [sec]&quot;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">print</span> <span class="p">)</span>
        <span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="s">&quot;In-place LU of A + 2 X Y^H&quot;</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Running this for float and double on a single core should for 4000 x 4000
matrices and rank-two updates on a recent Macbook Pro with Accelerate and
<code class="docutils literal notranslate"><span class="pre">VECLIB_MAXIMUM_THREADS=1</span></code> should yield results similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Testing</span> <span class="n">LU</span> <span class="n">updates</span> <span class="k">with</span> <span class="nb">float</span>
<span class="n">Initial</span> <span class="n">LU</span><span class="p">:</span> <span class="mf">1.01272</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">LU</span> <span class="n">update</span> <span class="n">of</span> <span class="n">rank</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">0.230531</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>

<span class="n">Testing</span> <span class="n">LU</span> <span class="n">updates</span> <span class="k">with</span> <span class="n">Complex</span><span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
<span class="n">Initial</span> <span class="n">LU</span><span class="p">:</span> <span class="mf">8.1526</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">LU</span> <span class="n">update</span> <span class="n">of</span> <span class="n">rank</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">0.268828</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>

<span class="n">Testing</span> <span class="n">LU</span> <span class="n">updates</span> <span class="k">with</span> <span class="n">double</span>
<span class="n">Initial</span> <span class="n">LU</span><span class="p">:</span> <span class="mf">1.96392</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">LU</span> <span class="n">update</span> <span class="n">of</span> <span class="n">rank</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">0.292697</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>

<span class="n">Testing</span> <span class="n">LU</span> <span class="n">updates</span> <span class="k">with</span> <span class="n">Complex</span><span class="o">&lt;</span><span class="n">double</span><span class="o">&gt;</span>
<span class="n">Initial</span> <span class="n">LU</span><span class="p">:</span> <span class="mf">15.9653</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">LU</span> <span class="n">update</span> <span class="n">of</span> <span class="n">rank</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">0.398748</span> <span class="p">[</span><span class="n">sec</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="qr">
<h4>QR<a class="headerlink" href="#qr" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="hermitian-eigensolvers-and-their-extensions">
<h3>Hermitian eigensolvers (and their extensions)<a class="headerlink" href="#hermitian-eigensolvers-and-their-extensions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="hermitian-eigensolvers">
<h4>Hermitian eigensolvers<a class="headerlink" href="#hermitian-eigensolvers" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="skew-hermitian-eigensolvers">
<h4>Skew-Hermitian eigensolvers<a class="headerlink" href="#skew-hermitian-eigensolvers" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="hermitian-generalized-definite-eigensolvers">
<h4>Hermitian generalized-definite eigensolvers<a class="headerlink" href="#hermitian-generalized-definite-eigensolvers" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="singular-value-decompositions">
<h3>Singular Value Decompositions<a class="headerlink" href="#singular-value-decompositions" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Field</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">TestSVD</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">m</span><span class="p">,</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">n</span><span class="p">,</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">rank</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;Testing SVD with &quot;</span><span class="p">,</span><span class="n">El</span><span class="o">::</span><span class="n">TypeName</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span><span class="p">());</span>
    <span class="k">typedef</span> <span class="n">El</span><span class="o">::</span><span class="n">Base</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">Real</span><span class="p">;</span>

    <span class="c1">// Form a random rank-r m x n matrix A := X Y</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">X</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">rank</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">rank</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Gemm</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">A</span> <span class="p">);</span>

    <span class="c1">// Decide on the details behind the SVD solver</span>
    <span class="n">El</span><span class="o">::</span><span class="n">SVDCtrl</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">ctrl</span><span class="p">;</span>
    <span class="n">ctrl</span><span class="p">.</span><span class="n">bidiagSVDCtrl</span><span class="p">.</span><span class="n">useQR</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span> <span class="c1">// This is the default option</span>
    <span class="c1">// We can choose between El::THIN_SVD, El::COMPACT_SVD, El::FULL_SVD,</span>
    <span class="c1">// and El::PRODUCT_SVD. A &#39;compact&#39; SVD is most appropriate when the rank</span>
    <span class="c1">// is less than the smallest dimension. &#39;Thin&#39; is the default.</span>
    <span class="n">ctrl</span><span class="p">.</span><span class="n">bidiagSVDCtrl</span><span class="p">.</span><span class="n">approach</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">COMPACT_SVD</span><span class="p">;</span>
    <span class="c1">// We can optionally request more accurate (but slower) internal QR</span>
    <span class="c1">// iterations at the base of our Divide and Conquer tree. The default is</span>
    <span class="c1">// El::RELATIVE_TO_MAX_SING_VAL_TOL.</span>
    <span class="n">ctrl</span><span class="p">.</span><span class="n">bidiagSVDCtrl</span><span class="p">.</span><span class="n">tolType</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">RELATIVE_TO_SELF_SING_VAL_TOL</span><span class="p">;</span>

    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">s</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">;</span>
    <span class="n">El</span><span class="o">::</span><span class="n">SVDInfo</span> <span class="n">info</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">SVD</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">ctrl</span> <span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span>
    <span class="p">(</span><span class="s">&quot;Number of secular equation iterations: &quot;</span><span class="p">,</span>
     <span class="n">info</span><span class="p">.</span><span class="n">bidiagSVDInfo</span><span class="p">.</span><span class="n">dcInfo</span><span class="p">.</span><span class="n">secularInfo</span><span class="p">.</span><span class="n">numIterations</span><span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span>
    <span class="p">(</span><span class="s">&quot;Number of secular equation deflations: &quot;</span><span class="p">,</span>
     <span class="n">info</span><span class="p">.</span><span class="n">bidiagSVDInfo</span><span class="p">.</span><span class="n">dcInfo</span><span class="p">.</span><span class="n">secularInfo</span><span class="p">.</span><span class="n">numDeflations</span><span class="p">);</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Output</span>
    <span class="p">(</span><span class="s">&quot;Number of internal QR iterations: &quot;</span><span class="p">,</span>
     <span class="n">info</span><span class="p">.</span><span class="n">bidiagSVDInfo</span><span class="p">.</span><span class="n">qrInfo</span><span class="p">.</span><span class="n">numIterations</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="schur-decompositions">
<h3>Schur decompositions<a class="headerlink" href="#schur-decompositions" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="pseudospectra">
<h3>Pseudospectra<a class="headerlink" href="#pseudospectra" title="Permalink to this headline">¶</a></h3>
<p>Elemental contains many different routines for computing one-norm and
two-norm pseudospectra, i.e.,</p>
<div class="math notranslate nohighlight">
\[\mathcal{L}_\epsilon^p(A) = \{ \xi \in \mathbb{C} : \| (A-\xi I)^{-1} \|_p &gt; \frac{1}{\epsilon} \},\]</div>
<p>but perhaps the simplest is via Elemental’s Python interface. For example,
the following Python script computes and visualizes the pseudospectra of the
famous Fox-Li/Landau matrices (of dimension 50, 100, and 300) over a 300 x 300
uniform grid.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">El</span>
<span class="k">if</span> <span class="n">El</span><span class="o">.</span><span class="n">havePyPlot</span><span class="p">:</span>
  <span class="n">El</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s1">&#39;bone&#39;</span><span class="p">)</span>
  <span class="c1"># pyplot.set_cmap seems to open an empty figure (which can be detected by</span>
  <span class="c1"># running pyplot.get_fignums()), and so we manually close it. Unfortunately,</span>
  <span class="c1"># some versions of pyplot generate a spurious warning of:</span>
  <span class="c1">#</span>
  <span class="c1">#   can&#39;t invoke &quot;event&quot; command: application has been destroyed</span>
  <span class="c1">#</span>
  <span class="c1"># when calling pyplot.close().</span>
  <span class="n">El</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">realRes</span> <span class="o">=</span> <span class="n">imagRes</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># grid resolution</span>

<span class="c1"># Display an instance of the Fox-Li/Landau matrix</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">El</span><span class="o">.</span><span class="n">DistMatrix</span><span class="p">(</span><span class="n">El</span><span class="o">.</span><span class="n">zTag</span><span class="p">)</span>

<span class="n">nList</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nList</span><span class="p">:</span>
  <span class="n">El</span><span class="o">.</span><span class="n">FoxLi</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

  <span class="c1"># Show the Real part of the matrix</span>
  <span class="n">AReal</span> <span class="o">=</span> <span class="n">El</span><span class="o">.</span><span class="n">DistMatrix</span><span class="p">(</span><span class="n">El</span><span class="o">.</span><span class="n">dTag</span><span class="p">)</span>
  <span class="n">El</span><span class="o">.</span><span class="n">RealPart</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">AReal</span><span class="p">)</span>
  <span class="n">El</span><span class="o">.</span><span class="n">Display</span><span class="p">(</span><span class="n">AReal</span><span class="p">,</span><span class="s1">&#39;Real part of Fox-Li matrix (n={})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

  <span class="c1"># Compute the Schur decomposition (overwriting A with the Schur factor)</span>
  <span class="n">schurStart</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
  <span class="n">w</span> <span class="o">=</span> <span class="n">El</span><span class="o">.</span><span class="n">Schur</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
  <span class="n">schurStop</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">Grid</span><span class="p">()</span><span class="o">.</span><span class="n">Rank</span><span class="p">()</span> <span class="ow">is</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Schur decomp for n={}: {} [sec]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">schurStop</span><span class="o">-</span><span class="n">schurStart</span><span class="p">,))</span>

  <span class="c1"># Compute the spectral portrait of the Schur factor</span>
  <span class="n">portraitStart</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
  <span class="n">portrait</span><span class="p">,</span> <span class="n">box</span> <span class="o">=</span> <span class="n">El</span><span class="o">.</span><span class="n">TriangularSpectralPortrait</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">realRes</span><span class="p">,</span><span class="n">imagRes</span><span class="p">)</span>
  <span class="n">portraitStop</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">Grid</span><span class="p">()</span><span class="o">.</span><span class="n">Rank</span><span class="p">()</span> <span class="ow">is</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Portrait for n={}: {} [sec]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">portraitStop</span><span class="o">-</span><span class="n">portraitStart</span><span class="p">,))</span>

  <span class="c1"># Display the eigenvalues on top of log10 plot of portrait</span>
  <span class="n">El</span><span class="o">.</span><span class="n">DisplayPortrait</span><span class="p">(</span><span class="n">portrait</span><span class="p">,</span><span class="n">box</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Fox-Li portrait (n={})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">),</span>
                     <span class="n">eigvals</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>

<span class="n">El</span><span class="o">.</span><span class="n">Finalize</span><span class="p">()</span>
</pre></div>
</div>
<p>An equivalent C++ program should should call the routines <cite>El::Schur</cite> and <cite>El::TriangularSpectralPortrait</cite>.</p>
<p>Some of the output of the above script includes the visualization of the real
part of the 50 x 50 discretization:</p>
<img alt="_images/FoxLiReal_50_trim.png" src="_images/FoxLiReal_50_trim.png" />
<p>as well as its pseudospectra:</p>
<img alt="_images/FoxLiPortrait_50_trim.png" src="_images/FoxLiPortrait_50_trim.png" />
<p>Similar pseudospectra are produced for the 100 x 100 and 300 x 300
discretizations:</p>
<img alt="_images/FoxLiPortrait_100_trim.png" src="_images/FoxLiPortrait_100_trim.png" />
<img alt="_images/FoxLiPortrait_300_trim.png" src="_images/FoxLiPortrait_300_trim.png" />
</div>
</div>
<div class="section" id="sparse-direct-linear-and-generalized-least-squares-solvers">
<h2>Sparse-direct linear and (generalized) least squares solvers<a class="headerlink" href="#sparse-direct-linear-and-generalized-least-squares-solvers" title="Permalink to this headline">¶</a></h2>
<div class="section" id="unpivoted-ldl">
<h3>Unpivoted LDL<a class="headerlink" href="#unpivoted-ldl" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="symmetric-quasi-semidefinite-sqsd-systems">
<h3>Symmetric Quasi-SemiDefinite (SQSD) systems<a class="headerlink" href="#symmetric-quasi-semidefinite-sqsd-systems" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="general-linear-systems">
<h3>General linear systems<a class="headerlink" href="#general-linear-systems" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="least-squares">
<h3>Least Squares<a class="headerlink" href="#least-squares" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="tikhonov">
<h3>Tikhonov<a class="headerlink" href="#tikhonov" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="equality-constrained-least-squares-lse">
<h3>Equality-constrained Least Squares (LSE)<a class="headerlink" href="#equality-constrained-least-squares-lse" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="general-linear-model-glm">
<h3>General Linear Model (GLM)<a class="headerlink" href="#general-linear-model-glm" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="solving-linear-quadratic-programs-and-second-order-cone-programs">
<h2>Solving Linear, Quadratic Programs, and Second-Order Cone Programs<a class="headerlink" href="#solving-linear-quadratic-programs-and-second-order-cone-programs" title="Permalink to this headline">¶</a></h2>
<p>Elemental contains sequential and distributed, dense and sparse, variable-precision, interfaces for solving Linear Programs, Quadratic Programs, and
Second-Order Cone Programs via primal-dual Interior Point Methods. Further,
each of these classes has solvers tailored to <em>direct conic form</em>, e.g.,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\min_x     &amp; \{\; c^T x  \; | \; A x = b,\; x \in \mathcal{K} \;\},\\
\max_{y,z} &amp; \{\; - b^T y \; | \; A^T y - z + c = 0,\; z \in \mathcal{K} \;\},\end{split}\]</div>
<p>and <em>affine conic form</em>, e.g.,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\min_{x,s} &amp; \{\; c^T x  \; | \; A x = b,\; G x + s = h,\; s \in \mathcal{K} \;\}, \\
\max_{y,z} &amp; \{\; - b^T y - h^T z \; | \; A^T y + G^T z + c = 0,\; z \in \mathcal{K} \;\},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{K}\)</span> is a product of Second-Order and Positive Orthant
cones. Since Elemental supports the gamut of floating-point types from <code class="docutils literal notranslate"><span class="pre">float</span></code>
up to <code class="docutils literal notranslate"><span class="pre">El::BigFloat</span></code>, one can solve Second-Order Cone Programs to 1000 digits
of accuracy (should one so desire).</p>
<div class="section" id="linear-programs">
<h3>Linear Programs<a class="headerlink" href="#linear-programs" title="Permalink to this headline">¶</a></h3>
<p>For example, one could solve a random dense LP with an arbitrary floating-point
type using:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Due to some equilibration routines having only been defined for all cases
except for sequential dense matrices, the following does not work in 0.87.5
but works in subsequent versions.</p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;El.hpp&gt;</span><span class="cp"></span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Real</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">RandomFeasibleLP</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">m</span><span class="p">,</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">n</span><span class="p">,</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">k</span> <span class="p">)</span>
<span class="p">{</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;Testing with &quot;</span><span class="p">,</span><span class="n">El</span><span class="o">::</span><span class="n">TypeName</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span><span class="p">());</span>
  <span class="c1">// Create random (primal feasible) inputs for the primal/dual problem</span>
  <span class="c1">//    arginf_{x,s} { c^T x | A x = b, G x + s = h, s &gt;= 0 }</span>
  <span class="c1">//    argsup_{y,z} { -b^T y - h^T z | A^T y + G^T z + c = 0, z &gt;= 0 }.</span>

  <span class="c1">// xFeas and sFeas are only used for problem generation</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">xFeas</span><span class="p">,</span> <span class="n">sFeas</span><span class="p">;</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">xFeas</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span> <span class="c1">// Sample over B_1(0)</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">sFeas</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">);</span> <span class="c1">// Sample over B_1(1)</span>

  <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">;</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="p">);</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">G</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span> <span class="p">);</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Gemv</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">A</span><span class="p">,</span> <span class="n">xFeas</span><span class="p">,</span> <span class="n">b</span> <span class="p">);</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Gemv</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">G</span><span class="p">,</span> <span class="n">xFeas</span><span class="p">,</span> <span class="n">h</span> <span class="p">);</span>
  <span class="n">h</span> <span class="o">+=</span> <span class="n">sFeas</span><span class="p">;</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>

  <span class="c1">// Solve the primal/dual Linear Program with the default options</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">s</span><span class="p">;</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Timer</span> <span class="n">timer</span><span class="p">;</span>
  <span class="n">timer</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
  <span class="n">El</span><span class="o">::</span><span class="n">LP</span><span class="p">(</span> <span class="n">A</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">s</span> <span class="p">);</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;Primal-dual LP took &quot;</span><span class="p">,</span><span class="n">timer</span><span class="p">.</span><span class="n">Stop</span><span class="p">(),</span><span class="s">&quot; seconds&quot;</span><span class="p">);</span>

  <span class="c1">// Print the primal and dual objective values</span>
  <span class="k">const</span> <span class="n">Real</span> <span class="n">primal</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">Dot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">x</span><span class="p">);</span>
  <span class="k">const</span> <span class="n">Real</span> <span class="n">dual</span> <span class="o">=</span> <span class="o">-</span><span class="n">El</span><span class="o">::</span><span class="n">Dot</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">El</span><span class="o">::</span><span class="n">Dot</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">z</span><span class="p">);</span>
  <span class="k">const</span> <span class="n">Real</span> <span class="n">relGap</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">Abs</span><span class="p">(</span><span class="n">primal</span><span class="o">-</span><span class="n">dual</span><span class="p">)</span> <span class="o">/</span> <span class="n">El</span><span class="o">::</span><span class="n">Max</span><span class="p">(</span><span class="n">El</span><span class="o">::</span><span class="n">Abs</span><span class="p">(</span><span class="n">dual</span><span class="p">),</span><span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;c^T x = &quot;</span><span class="p">,</span><span class="n">primal</span><span class="p">);</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;-b^T y - h^T z = &quot;</span><span class="p">,</span><span class="n">dual</span><span class="p">);</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;|gap| / max( |dual|, 1 ) = &quot;</span><span class="p">,</span><span class="n">relGap</span><span class="p">);</span>

  <span class="c1">// Print the relative primal feasibility residual,</span>
  <span class="c1">//   || A x - b ||_2 / max( || b ||_2, 1 ).</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">rPrimal</span><span class="p">;</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Gemv</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">NORMAL</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">rPrimal</span> <span class="p">);</span>
  <span class="n">rPrimal</span> <span class="o">-=</span> <span class="n">b</span><span class="p">;</span>
  <span class="k">const</span> <span class="n">Real</span> <span class="n">bFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">b</span> <span class="p">);</span>
  <span class="k">const</span> <span class="n">Real</span> <span class="n">rPrimalFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">rPrimal</span> <span class="p">);</span>
  <span class="k">const</span> <span class="n">Real</span> <span class="n">primalRelResid</span> <span class="o">=</span> <span class="n">rPrimalFrob</span> <span class="o">/</span> <span class="n">El</span><span class="o">::</span><span class="n">Max</span><span class="p">(</span> <span class="n">bFrob</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">);</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;|| A x - b ||_2 / || b ||_2 = &quot;</span><span class="p">,</span><span class="n">primalRelResid</span><span class="p">);</span>

  <span class="c1">// Print the relative dual feasiability residual,</span>
  <span class="c1">//   || A^T y + G^T z + c ||_2 / max( || c ||_2, 1 ).</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">rDual</span><span class="p">;</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Gemv</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">TRANSPOSE</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">A</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rDual</span> <span class="p">);</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Gemv</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">TRANSPOSE</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">G</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">rDual</span> <span class="p">);</span>
  <span class="n">rDual</span> <span class="o">+=</span> <span class="n">c</span><span class="p">;</span>
  <span class="k">const</span> <span class="n">Real</span> <span class="n">cFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">c</span> <span class="p">);</span>
  <span class="k">const</span> <span class="n">Real</span> <span class="n">rDualFrob</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">rDual</span> <span class="p">);</span>
  <span class="k">const</span> <span class="n">Real</span> <span class="n">dualRelResid</span> <span class="o">=</span> <span class="n">rDualFrob</span> <span class="o">/</span> <span class="n">El</span><span class="o">::</span><span class="n">Max</span><span class="p">(</span> <span class="n">cFrob</span><span class="p">,</span> <span class="n">Real</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">);</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span>
  <span class="p">(</span><span class="s">&quot;|| A^T y + G^T z + c ||_2 / max( || c ||_2, 1 ) = &quot;</span><span class="p">,</span><span class="n">dualRelResid</span><span class="p">);</span>
  <span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With a driver such as</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">El</span><span class="o">::</span><span class="n">Environment</span> <span class="n">env</span><span class="p">(</span> <span class="n">argc</span><span class="p">,</span> <span class="n">argv</span> <span class="p">);</span>
    <span class="k">try</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">m</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">Input</span><span class="p">(</span><span class="s">&quot;--m&quot;</span><span class="p">,</span><span class="s">&quot;height of A&quot;</span><span class="p">,</span><span class="mi">70</span><span class="p">);</span>
        <span class="k">const</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">Input</span><span class="p">(</span><span class="s">&quot;--n&quot;</span><span class="p">,</span><span class="s">&quot;width of A&quot;</span><span class="p">,</span><span class="mi">80</span><span class="p">);</span>
        <span class="k">const</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">Input</span><span class="p">(</span><span class="s">&quot;--k&quot;</span><span class="p">,</span><span class="s">&quot;height of G&quot;</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span>
        <span class="n">El</span><span class="o">::</span><span class="n">ProcessInput</span><span class="p">();</span>

        <span class="n">RandomFeasibleLP</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="p">);</span>
        <span class="n">RandomFeasibleLP</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="p">);</span>
<span class="cp">#ifdef EL_HAVE_QD</span>
        <span class="n">RandomFeasibleLP</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">DoubleDouble</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="p">);</span>
        <span class="n">RandomFeasibleLP</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">QuadDouble</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="p">);</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef EL_HAVE_QUAD</span>
        <span class="n">RandomFeasibleLP</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">Quad</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="p">);</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef EL_HAVE_MPC</span>
        <span class="n">RandomFeasibleLP</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">BigFloat</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="p">);</span>
<span class="cp">#endif</span>
    <span class="p">}</span>
    <span class="k">catch</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">e</span> <span class="p">)</span> <span class="p">{</span> <span class="n">El</span><span class="o">::</span><span class="n">ReportException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>one should see output of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Testing</span> <span class="k">with</span> <span class="nb">float</span>
<span class="n">Primal</span><span class="o">-</span><span class="n">dual</span> <span class="n">LP</span> <span class="n">took</span> <span class="n">XXX</span> <span class="n">seconds</span>
<span class="n">c</span><span class="o">^</span><span class="n">T</span> <span class="n">x</span> <span class="o">=</span> <span class="n">XXX</span>
<span class="o">-</span><span class="n">b</span><span class="o">^</span><span class="n">T</span> <span class="n">y</span> <span class="o">-</span> <span class="n">h</span><span class="o">^</span><span class="n">T</span> <span class="n">z</span> <span class="o">=</span> <span class="n">XXX</span>
<span class="o">|</span><span class="n">gap</span><span class="o">|</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span> <span class="o">|</span><span class="n">dual</span><span class="o">|</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">5.53131e-05</span>
<span class="o">||</span> <span class="n">A</span> <span class="n">x</span> <span class="o">-</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">1.38188e-07</span>
<span class="o">||</span> <span class="n">A</span><span class="o">^</span><span class="n">T</span> <span class="n">y</span> <span class="o">+</span> <span class="n">G</span><span class="o">^</span><span class="n">T</span> <span class="n">z</span> <span class="o">+</span> <span class="n">c</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span> <span class="o">||</span> <span class="n">c</span> <span class="o">||</span><span class="n">_2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">9.74921e-07</span>

<span class="n">Testing</span> <span class="k">with</span> <span class="n">double</span>
<span class="n">Primal</span><span class="o">-</span><span class="n">dual</span> <span class="n">LP</span> <span class="n">took</span> <span class="n">XXX</span> <span class="n">seconds</span>
<span class="n">c</span><span class="o">^</span><span class="n">T</span> <span class="n">x</span> <span class="o">=</span> <span class="n">XXX</span>
<span class="o">-</span><span class="n">b</span><span class="o">^</span><span class="n">T</span> <span class="n">y</span> <span class="o">-</span> <span class="n">h</span><span class="o">^</span><span class="n">T</span> <span class="n">z</span> <span class="o">=</span> <span class="n">XXX</span>
<span class="o">|</span><span class="n">gap</span><span class="o">|</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span> <span class="o">|</span><span class="n">dual</span><span class="o">|</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">4.88859e-10</span>
<span class="o">||</span> <span class="n">A</span> <span class="n">x</span> <span class="o">-</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">2.7623e-16</span>
<span class="o">||</span> <span class="n">A</span><span class="o">^</span><span class="n">T</span> <span class="n">y</span> <span class="o">+</span> <span class="n">G</span><span class="o">^</span><span class="n">T</span> <span class="n">z</span> <span class="o">+</span> <span class="n">c</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span> <span class="o">||</span> <span class="n">c</span> <span class="o">||</span><span class="n">_2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">2.17927e-15</span>

<span class="n">Testing</span> <span class="k">with</span> <span class="n">DoubleDouble</span>
<span class="n">Primal</span><span class="o">-</span><span class="n">dual</span> <span class="n">LP</span> <span class="n">took</span> <span class="n">XXX</span> <span class="n">seconds</span>
<span class="n">c</span><span class="o">^</span><span class="n">T</span> <span class="n">x</span> <span class="o">=</span> <span class="n">XXX</span>
<span class="o">-</span><span class="n">b</span><span class="o">^</span><span class="n">T</span> <span class="n">y</span> <span class="o">-</span> <span class="n">h</span><span class="o">^</span><span class="n">T</span> <span class="n">z</span> <span class="o">=</span> <span class="n">XXX</span>
<span class="o">|</span><span class="n">gap</span><span class="o">|</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span> <span class="o">|</span><span class="n">dual</span><span class="o">|</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">7.278639e-18</span>
<span class="o">||</span> <span class="n">A</span> <span class="n">x</span> <span class="o">-</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">4.697166e-32</span>
<span class="o">||</span> <span class="n">A</span><span class="o">^</span><span class="n">T</span> <span class="n">y</span> <span class="o">+</span> <span class="n">G</span><span class="o">^</span><span class="n">T</span> <span class="n">z</span> <span class="o">+</span> <span class="n">c</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span> <span class="o">||</span> <span class="n">c</span> <span class="o">||</span><span class="n">_2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">1.025945e-18</span>

<span class="n">Testing</span> <span class="k">with</span> <span class="n">QuadDouble</span>
<span class="n">Primal</span><span class="o">-</span><span class="n">dual</span> <span class="n">LP</span> <span class="n">took</span> <span class="n">XXX</span> <span class="n">seconds</span>
<span class="n">c</span><span class="o">^</span><span class="n">T</span> <span class="n">x</span> <span class="o">=</span> <span class="n">XXX</span>
<span class="o">-</span><span class="n">b</span><span class="o">^</span><span class="n">T</span> <span class="n">y</span> <span class="o">-</span> <span class="n">h</span><span class="o">^</span><span class="n">T</span> <span class="n">z</span> <span class="o">=</span> <span class="n">XXX</span>
<span class="o">|</span><span class="n">gap</span><span class="o">|</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span> <span class="o">|</span><span class="n">dual</span><span class="o">|</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">1.421369e-33</span>
<span class="o">||</span> <span class="n">A</span> <span class="n">x</span> <span class="o">-</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">7.062635e-65</span>
<span class="o">||</span> <span class="n">A</span><span class="o">^</span><span class="n">T</span> <span class="n">y</span> <span class="o">+</span> <span class="n">G</span><span class="o">^</span><span class="n">T</span> <span class="n">z</span> <span class="o">+</span> <span class="n">c</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span> <span class="o">||</span> <span class="n">c</span> <span class="o">||</span><span class="n">_2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">3.568571e-36</span>

<span class="n">Testing</span> <span class="k">with</span> <span class="n">Quad</span>
<span class="n">Primal</span><span class="o">-</span><span class="n">dual</span> <span class="n">LP</span> <span class="n">took</span> <span class="n">XXX</span> <span class="n">seconds</span>
<span class="n">c</span><span class="o">^</span><span class="n">T</span> <span class="n">x</span> <span class="o">=</span> <span class="n">XXX</span>
<span class="o">-</span><span class="n">b</span><span class="o">^</span><span class="n">T</span> <span class="n">y</span> <span class="o">-</span> <span class="n">h</span><span class="o">^</span><span class="n">T</span> <span class="n">z</span> <span class="o">=</span> <span class="n">XXX</span>
<span class="o">|</span><span class="n">gap</span><span class="o">|</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span> <span class="o">|</span><span class="n">dual</span><span class="o">|</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">2.508642e-18</span>
<span class="o">||</span> <span class="n">A</span> <span class="n">x</span> <span class="o">-</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">3.923351e-34</span>
<span class="o">||</span> <span class="n">A</span><span class="o">^</span><span class="n">T</span> <span class="n">y</span> <span class="o">+</span> <span class="n">G</span><span class="o">^</span><span class="n">T</span> <span class="n">z</span> <span class="o">+</span> <span class="n">c</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span> <span class="o">||</span> <span class="n">c</span> <span class="o">||</span><span class="n">_2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">3.076727e-20</span>

<span class="n">Testing</span> <span class="k">with</span> <span class="n">BigFloat</span>
<span class="n">Primal</span><span class="o">-</span><span class="n">dual</span> <span class="n">LP</span> <span class="n">took</span> <span class="n">XXX</span> <span class="n">seconds</span>
<span class="n">c</span><span class="o">^</span><span class="n">T</span> <span class="n">x</span> <span class="o">=</span> <span class="n">XXX</span>
<span class="o">-</span><span class="n">b</span><span class="o">^</span><span class="n">T</span> <span class="n">y</span> <span class="o">-</span> <span class="n">h</span><span class="o">^</span><span class="n">T</span> <span class="n">z</span> <span class="o">=</span> <span class="n">XXX</span>
<span class="o">|</span><span class="n">gap</span><span class="o">|</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span> <span class="o">|</span><span class="n">dual</span><span class="o">|</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">8.12654984542403493113930928544054111846416192203054855606794438829784991753557e-41</span>
<span class="o">||</span> <span class="n">A</span> <span class="n">x</span> <span class="o">-</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="o">||</span> <span class="n">b</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">3.41872271095398980556412036957797890873177437849829019239512280050095223533333e-77</span>
<span class="o">||</span> <span class="n">A</span><span class="o">^</span><span class="n">T</span> <span class="n">y</span> <span class="o">+</span> <span class="n">G</span><span class="o">^</span><span class="n">T</span> <span class="n">z</span> <span class="o">+</span> <span class="n">c</span> <span class="o">||</span><span class="n">_2</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span> <span class="o">||</span> <span class="n">c</span> <span class="o">||</span><span class="n">_2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">2.20856170189320269413056964848038584344997345561703519520787934256169419209754e-42</span>
</pre></div>
</div>
</div>
<div class="section" id="quadratic-programs">
<h3>Quadratic Programs<a class="headerlink" href="#quadratic-programs" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="second-order-cone-programs">
<h3>Second-Order Cone Programs<a class="headerlink" href="#second-order-cone-programs" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="lattice-reduction">
<h2>Lattice reduction<a class="headerlink" href="#lattice-reduction" title="Permalink to this headline">¶</a></h2>
<div class="section" id="lenstra-lenstra-lovasz-lll-basis-reduction">
<h3>Lenstra/Lenstra/Lovasz (LLL) basis reduction<a class="headerlink" href="#lenstra-lenstra-lovasz-lll-basis-reduction" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="block-korkine-zolotarev-basis-reduction-and-its-extensions">
<h3>Block Korkine-Zolotarev basis reduction (and its extensions)<a class="headerlink" href="#block-korkine-zolotarev-basis-reduction-and-its-extensions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="vanilla-bkz">
<h4>Vanilla BKZ<a class="headerlink" href="#vanilla-bkz" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="bkz-2-0">
<h4>“BKZ 2.0”<a class="headerlink" href="#bkz-2-0" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="y-sparse-enumeration">
<h4>“y-sparse” enumeration<a class="headerlink" href="#y-sparse-enumeration" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="solving-shortest-vector-problems">
<h3>Solving Shortest Vector Problems<a class="headerlink" href="#solving-shortest-vector-problems" title="Permalink to this headline">¶</a></h3>
<p>Elemental has fairly unique support for solving complex-valued Shortest Vector
Problems. For example we can search for a short vector (via BKZ(15)) in a
knapsack-type basis of dimension 20 with a bottom row uniformly sampled within
the unit ball of radius one million via:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">blocksize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
<span class="k">const</span> <span class="n">El</span><span class="o">::</span><span class="n">Int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">radius</span> <span class="o">=</span> <span class="mf">1.e6</span><span class="p">;</span>

<span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">Complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">B</span><span class="p">;</span>
<span class="n">El</span><span class="o">::</span><span class="n">KnapsackTypeBasis</span><span class="p">(</span> <span class="n">B</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">radius</span> <span class="p">);</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">BOrigOne</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">OneNorm</span><span class="p">(</span> <span class="n">B</span> <span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;|| B_orig ||_1 = &quot;</span><span class="p">,</span><span class="n">BOrigOne</span><span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">B</span><span class="p">,</span> <span class="s">&quot;BOrig&quot;</span> <span class="p">);</span>

<span class="n">El</span><span class="o">::</span><span class="n">BKZCtrl</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">ctrl</span><span class="p">;</span>
<span class="n">ctrl</span><span class="p">.</span><span class="n">blocksize</span> <span class="o">=</span> <span class="n">blocksize</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">double</span> <span class="n">startTime</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">mpi</span><span class="o">::</span><span class="n">Time</span><span class="p">();</span>
<span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">El</span><span class="o">::</span><span class="n">Complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">R</span><span class="p">;</span>
<span class="k">auto</span> <span class="n">info</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">BKZ</span><span class="p">(</span> <span class="n">B</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">ctrl</span> <span class="p">);</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">runTime</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">mpi</span><span class="o">::</span><span class="n">Time</span><span class="p">()</span> <span class="o">-</span> <span class="n">startTime</span><span class="p">;</span>
<span class="n">El</span><span class="o">::</span><span class="n">Output</span>
<span class="p">(</span><span class="s">&quot;  BKZ(&quot;</span><span class="p">,</span><span class="n">blocksize</span><span class="p">,</span><span class="s">&quot;,&quot;</span><span class="p">,</span><span class="n">delta</span><span class="p">,</span><span class="s">&quot;,&quot;</span><span class="p">,</span><span class="n">eta</span><span class="p">,</span><span class="s">&quot;) took &quot;</span><span class="p">,</span><span class="n">runTime</span><span class="p">,</span><span class="s">&quot; seconds&quot;</span><span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;    achieved delta:   &quot;</span><span class="p">,</span><span class="n">info</span><span class="p">.</span><span class="n">delta</span><span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;    achieved eta:     &quot;</span><span class="p">,</span><span class="n">info</span><span class="p">.</span><span class="n">eta</span><span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;    num swaps:        &quot;</span><span class="p">,</span><span class="n">info</span><span class="p">.</span><span class="n">numSwaps</span><span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;    num enums:        &quot;</span><span class="p">,</span><span class="n">info</span><span class="p">.</span><span class="n">numEnums</span><span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;    num failed enums: &quot;</span><span class="p">,</span><span class="n">info</span><span class="p">.</span><span class="n">numEnumFailures</span><span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;    log(vol(L)):      &quot;</span><span class="p">,</span><span class="n">info</span><span class="p">.</span><span class="n">logVol</span><span class="p">);</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">GH</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">LatticeGaussianHeuristic</span><span class="p">(</span> <span class="n">info</span><span class="p">.</span><span class="n">rank</span><span class="p">,</span> <span class="n">info</span><span class="p">.</span><span class="n">logVol</span> <span class="p">);</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">challenge</span> <span class="o">=</span> <span class="n">targetRatio</span><span class="o">*</span><span class="n">GH</span><span class="p">;</span>
<span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;    GH(L):             &quot;</span><span class="p">,</span><span class="n">GH</span><span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;    targetRatio*GH(L): &quot;</span><span class="p">,</span><span class="n">challenge</span><span class="p">);</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">BOneNorm</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">OneNorm</span><span class="p">(</span> <span class="n">B</span> <span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;|| B ||_1 = &quot;</span><span class="p">,</span><span class="n">BOneNorm</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">b0</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span> <span class="n">El</span><span class="o">::</span><span class="n">ALL</span><span class="p">,</span> <span class="n">El</span><span class="o">::</span><span class="n">IR</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">);</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">b0Norm</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">FrobeniusNorm</span><span class="p">(</span> <span class="n">b0</span> <span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Output</span><span class="p">(</span><span class="s">&quot;|| b_0 ||_2 = &quot;</span><span class="p">,</span><span class="n">b0Norm</span><span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Print</span><span class="p">(</span> <span class="n">b0</span><span class="p">,</span> <span class="s">&quot;b0&quot;</span> <span class="p">);</span>
</pre></div>
</div>
<p>Running such a program should produce an output of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">||</span> <span class="n">B_orig</span> <span class="o">||</span><span class="n">_1</span> <span class="o">=</span> <span class="mi">933416</span>
<span class="n">BOrig</span>
<span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">668149</span><span class="o">+-</span><span class="mi">143040</span><span class="n">i</span> <span class="o">-</span><span class="mi">115412</span><span class="o">+-</span><span class="mi">37575</span><span class="n">i</span> <span class="o">-</span><span class="mi">261199</span><span class="o">+-</span><span class="mi">400829</span><span class="n">i</span> <span class="o">-</span><span class="mi">741830</span><span class="o">+</span><span class="mi">252950</span><span class="n">i</span> <span class="mi">926075</span><span class="o">+-</span><span class="mi">8490</span><span class="n">i</span> <span class="mi">781004</span><span class="o">+</span><span class="mi">180128</span><span class="n">i</span> <span class="o">-</span><span class="mi">97427</span><span class="o">+-</span><span class="mi">363934</span><span class="n">i</span> <span class="o">-</span><span class="mi">7501</span><span class="o">+-</span><span class="mi">144117</span><span class="n">i</span> <span class="mi">102183</span><span class="o">+</span><span class="mi">533991</span><span class="n">i</span> <span class="o">-</span><span class="mi">777958</span><span class="o">+</span><span class="mi">515795</span><span class="n">i</span> <span class="o">-</span><span class="mi">248767</span><span class="o">+</span><span class="mi">201953</span><span class="n">i</span> <span class="o">-</span><span class="mi">173494</span><span class="o">+</span><span class="mi">113497</span><span class="n">i</span> <span class="mi">247815</span><span class="o">+</span><span class="mi">484513</span><span class="n">i</span> <span class="mi">92420</span><span class="o">+</span><span class="mi">412569</span><span class="n">i</span> <span class="o">-</span><span class="mi">151694</span><span class="o">+</span><span class="mi">134284</span><span class="n">i</span> <span class="mi">550082</span><span class="o">+-</span><span class="mi">285722</span><span class="n">i</span> <span class="o">-</span><span class="mi">312183</span><span class="o">+-</span><span class="mi">1197</span><span class="n">i</span> <span class="mi">467495</span><span class="o">+</span><span class="mi">570767</span><span class="n">i</span> <span class="mi">91402</span><span class="o">+</span><span class="mi">242320</span><span class="n">i</span> <span class="mi">38949</span><span class="o">+</span><span class="mi">212937</span><span class="n">i</span>

<span class="n">BKZ</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mf">0.9999</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span> <span class="n">took</span> <span class="mf">2.66103</span> <span class="n">seconds</span>
  <span class="n">achieved</span> <span class="n">delta</span><span class="p">:</span>   <span class="mf">1.01546</span>
  <span class="n">achieved</span> <span class="n">eta</span><span class="p">:</span>     <span class="mf">0.492272</span>
  <span class="n">num</span> <span class="n">swaps</span><span class="p">:</span>        <span class="mi">3304</span>
  <span class="n">num</span> <span class="n">enums</span><span class="p">:</span>        <span class="mi">86</span>
  <span class="n">num</span> <span class="n">failed</span> <span class="n">enums</span><span class="p">:</span> <span class="mi">16</span>
  <span class="n">log</span><span class="p">(</span><span class="n">vol</span><span class="p">(</span><span class="n">L</span><span class="p">)):</span>      <span class="mf">14.7077</span>
  <span class="n">GH</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>             <span class="mf">2.50488</span>
  <span class="n">targetRatio</span><span class="o">*</span><span class="n">GH</span><span class="p">(</span><span class="n">L</span><span class="p">):</span> <span class="mf">2.63013</span>

<span class="o">||</span> <span class="n">B</span> <span class="o">||</span><span class="n">_1</span> <span class="o">=</span> <span class="mf">20.8284</span>
<span class="o">||</span> <span class="n">b_0</span> <span class="o">||</span><span class="n">_2</span> <span class="o">=</span> <span class="mf">3.60555</span>
<span class="n">b0</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+-</span><span class="mi">1</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+-</span><span class="mi">1</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">1</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="o">-</span><span class="mi">1</span><span class="o">+-</span><span class="mi">1</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+-</span><span class="mi">1</span><span class="n">i</span>
<span class="mi">1</span><span class="o">+-</span><span class="mi">1</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
<span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">i</span>
</pre></div>
</div>
<p>One can also easily solve
<a class="reference external" href="https://www.latticechallenge.org/svp-challenge/download/challenges/svpchallengedim40seed0.txt">SVPChallenge 40</a> via Elemental’s BKZ.
(Though it is important to note that Elemental does not <em>yet</em> support the
important aggressive precision-dropping optimization of libraries such as
<a class="reference external" href="http://www.shoup.net/ntl/">NTL</a> and
<a class="reference external" href="https://github.com/fplll/fplll">FPLLL</a>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is no agreed-upon convention for whether lattices should be represented
as collections of column or row vectors. Elemental adopts the convention of
column vectors, whereas the SVP Challenge uses row vectors. For this reason,
in addition to <cite>[</cite> and <cite>]</cite> symbols needing to be removed from the above link,
the matrix is transposed in the code below.</p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">BTrans</span><span class="p">;</span>
<span class="n">El</span><span class="o">::</span><span class="n">Read</span><span class="p">(</span> <span class="n">BTrans</span><span class="p">,</span> <span class="s">&quot;SVPChallenge-40.txt&quot;</span> <span class="p">);</span>
<span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">B</span><span class="p">;</span>
<span class="n">El</span><span class="o">::</span><span class="n">Transpose</span><span class="p">(</span> <span class="n">BTrans</span><span class="p">,</span> <span class="n">B</span> <span class="p">);</span>

<span class="n">El</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">R</span><span class="p">;</span> <span class="c1">// Will hold the &#39;R&#39; of the QR factorization of final B</span>
<span class="n">El</span><span class="o">::</span><span class="n">BKZCtrl</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span> <span class="n">ctrl</span><span class="p">;</span> <span class="c1">// One can modify the members to customize BKZ</span>
<span class="n">ctrl</span><span class="p">.</span><span class="n">blocksize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c1">// Enumerate over windows of 20 vectors at a time</span>
<span class="k">auto</span> <span class="n">info</span> <span class="o">=</span> <span class="n">El</span><span class="o">::</span><span class="n">BKZ</span><span class="p">(</span> <span class="n">B</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">ctrl</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="integer-dependence-searches">
<h3>Integer dependence searches<a class="headerlink" href="#integer-dependence-searches" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="some-simple-number-theory-support">
<h2>Some simple number theory support<a class="headerlink" href="#some-simple-number-theory-support" title="Permalink to this headline">¶</a></h2>
<div class="section" id="simple-integer-factorization">
<h3>Simple integer factorization<a class="headerlink" href="#simple-integer-factorization" title="Permalink to this headline">¶</a></h3>
<div class="section" id="direct-sieving">
<h4>Direct sieving<a class="headerlink" href="#direct-sieving" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="pollard-s-rho-method">
<h4>Pollard’s rho method<a class="headerlink" href="#pollard-s-rho-method" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="pollard-s-p-1-method">
<h4>Pollard’s p-1 method<a class="headerlink" href="#pollard-s-p-1-method" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="discrete-logarithms">
<h3>Discrete logarithms<a class="headerlink" href="#discrete-logarithms" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="citation">
<dt class="label" id="petal2013"><span class="brackets">PEtAl2013</span></dt>
<dd><p>Jack Poulson, Bryan Marker, Robert A. van de Geijn, Jeff R. Hammond, and Nichols A. Romero, <em>Elemental: A new framework for distributed memory dense matrix computations</em>, ACM Transactions on Mathematical Software, Vol. 39, Issue 2, Article No. 13, 2013. DOI: <a class="reference external" href="http://dx.doi.org/10.1145/2427023.2427030">http://dx.doi.org/10.1145/2427023.2427030</a></p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="build.html" class="btn btn-neutral float-right" title="Build system" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="intro.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2009-2016, Jack Poulson

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>